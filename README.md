# IDP-wcomp

Welcome to the beta version of this IDP ensemble comparison tool. The method implemented in this jupyter notebook computes residue-specific distances between a pair of IDP conformational ensembles, together with an overall distance for the entire ensemble. The comparison is simultaneously made at two scales:
* Global scale: distances between the distributions of the relative positions of all residue pairs in both ensembles. For each pair of residues, we compute the (2-Wasserstein) distance between a pair of probability distributions supported on the three-dimensional euclidean space (point clouds).
* Local scale: distances between the (phi, psi) angle distributions of each ensemble, for each residue along the sequence. For each residue, we compute the (2-Wasserstein) distance between a pair of probability distributions supported on the two dimensional flat torus.

Results are returned through a distance matrix, depicting both scales' results: global distances are included in the lower triangle and local distances along the diagonal. Computations include a correction to mitigate the effect of uncertainty. To apply the comparison tool for a given pair of IDP ensembles, the user can directly execute the [comparison_tool](https://github.com/gonzalez-delgado/IDP-wcomp/blob/master/comparison_tool.ipynb) file, which contains its specific instructions and guidelines. This file calls all the other notebooks included in the same folder, which can also be used individually if desired. 

Before running the function, be sure to set Python version to 3.8 and to have installed all of the following libraries: [numpy](https://numpy.org/), [os](https://docs.python.org/3/library/os.html), [tqdm](https://tqdm.github.io/), [joblib](https://joblib.readthedocs.io/en/latest/), [functools](https://docs.python.org/3/library/functools.html), [mdtraj](https://www.mdtraj.org/1.9.8.dev0/index.html), [h5py](https://docs.h5py.org/en/stable/), [itertools](https://docs.python.org/3/library/itertools.html), [pandas](https://pandas.pydata.org/), [warnings](https://docs.python.org/3/library/warnings.html), [Bio](https://biopython.org/), [time](https://docs.python.org/3/library/time.html), [shutil](https://docs.python.org/3/library/shutil.html), [seaborn](https://seaborn.pydata.org/), [matplotlib](https://matplotlib.org/), [mdanalysis](https://www.mdanalysis.org/), [ot](https://pythonot.github.io/), [scipy](https://scipy.org/) and [faiss](https://faiss.ai/).
